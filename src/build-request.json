{
  "kind": "build_request",
  "title": "Require Stripe setup before item creation with profile completion guidance",
  "projectName": "Artist Marketplace",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-20",
      "text": "Update the CreateItemForm component to check if the authenticated user has configured Stripe settings before allowing item creation. If Stripe is not configured, display a message guiding the user to complete their artist profile in Settings first, with a prominent link to the Settings page.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-final"
        ],
        "quotes": [
          "Users must now set up their artist profile with Stripe settings before they can create items. The Create Item page will guide them to complete their profile first."
        ]
      },
      "acceptanceCriteria": [
        "CreateItemForm checks if the current user has Stripe configuration before rendering the item creation form",
        "If Stripe is not configured, the form displays a clear message explaining that Stripe setup is required",
        "The message includes a clickable link or button that navigates to the Settings page (/settings)",
        "The actual item creation form fields are hidden or disabled until Stripe configuration is complete",
        "The check uses the existing getUserStripeConfig query hook to determine Stripe configuration status"
      ]
    },
    {
      "id": "REQ-21",
      "text": "Add a query hook in useQueries.ts to fetch the current user's Stripe configuration status, enabling the CreateItemForm to check if Stripe settings are configured before allowing item creation.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-final"
        ]
      },
      "acceptanceCriteria": [
        "New React Query hook getUserStripeConfig is created that calls the backend getUserStripeConfig method",
        "The hook returns the user's Stripe configuration if it exists, or null/undefined if not configured",
        "The hook is properly typed with TypeScript interfaces matching the backend StripeConfig type",
        "The hook uses the actor instance from useActor and handles authentication state correctly"
      ]
    }
  ],
  "constraints": [
    "Do not modify the backend/main.mo file - use existing getUserStripeConfig method",
    "Do not change the Settings page implementation - only update the CreateItemForm",
    "Preserve the existing CreateItemForm validation for artist status (isArtist check)",
    "Use existing React Query patterns from useQueries.ts for the new Stripe config query"
  ],
  "nonGoals": [
    "Modifying the Stripe configuration setup interface in the Settings page",
    "Changing the backend Stripe storage structure or methods",
    "Adding new Stripe configuration fields or validation rules",
    "Implementing automatic Stripe setup workflows or wizards"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}